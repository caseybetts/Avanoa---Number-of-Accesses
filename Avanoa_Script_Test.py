# Author: Casey Betts, 2024
# This script outputs data on how many accesses the given orders have on a given day
# Requirements: all onv layers and active ufp layer in the table of contents with the correct names

import arcpy
from functools import reduce

def get_layer_by_name(layer_name, map):
    """
    Returns the first layer in the TOC of the given name

    :param layer_name: String, the name of the layer to be returned
    :param map: Map Object, the map containing the layer
    """

    # Find the layer
    for layer in map.listLayers():
        if layer.name == layer_name:
            return layer
    else:
        raise Exception(f"Source layer '{layer_name}' not found in the TOC.")

# Select the available orders on a given layer
def select_available_orders(orders_layer, onv_layer, scid):
    """ Select orders accessable on a given rev based on the order's max ONA vlaue """

    arcpy.AddMessage(f"Running available_orders for {scid}.....")

    # Definition query values
    ona_values = [35, 30, 25, 20, 15]
    
    # Select orders intersecting the 45deg segments of the rev (max selection)
    arcpy.management.SelectLayerByLocation(orders_layer, "INTERSECT", onv_layer, None, "NEW_SELECTION")

    # Select only the orders that are avaialble based on their max ONA value    
    for ona in ona_values:

        # Deselect orders with ONA under current value
        arcpy.management.SelectLayerByAttribute(orders_layer, "REMOVE_FROM_SELECTION", "max_ona < " + str(ona + 1), None)

        # Create an onv feature
        feature_layer = arcpy.management.MakeFeatureLayer(onv_layer, "FeatureLayer", f"ona = {ona}")

        # Select orders intersecting the current onv feature layer
        arcpy.management.SelectLayerByLocation(orders_layer, "INTERSECT", feature_layer, None, "ADD_TO_SELECTION")

    # Deselect orders that do not use the spacecraft consitant with the onv
    arcpy.management.SelectLayerByAttribute(orders_layer, "REMOVE_FROM_SELECTION", scid + " = 0", None)

    arcpy.AddMessage("Done")

def create_available_orders_featuer_class(scid, m):
    """ Create a feature class of all available orders on a given spacecraft and return the list of order ids"""

    # get the onv and orders layers
    onv_layer = get_layer_by_name('onv_'+scid+'_Avanoa', m)
    orders_layer = get_layer_by_name('active_orders_ufp_Avanoa', m)

    # Select the available orders on the orders layer
    select_available_orders(orders_layer, onv_layer, scid)

    # Export the selection to the defalut GDB
    temp_layer = arcpy.env.workspace + "\\" + 'available_' + scid + '_temp'
    arcpy.conversion.ExportFeatures(orders_layer, temp_layer)

    # Create a list of order ids
    with arcpy.da.SearchCursor(temp_layer, ["external_id"]) as cursor:
        active_orders = [row[0] for row in cursor]

    arcpy.AddMessage(scid + " :" + str(active_orders[:10]))

    return active_orders

def get_selected(layer, field):
    """ Returns a list of order ids from the given layer that are currently selected """

    desc = arcpy.Describe(layer)
    oid_field = desc.OIDFieldName 

    # Create a list of selected rows
    with arcpy.da.SearchCursor(layer, [oid_field]) as cursor:
        selected_ids = [str(row[0]) for row in cursor]

    selected_field = []
    # Create a list of values from the given field
    with arcpy.da.SearchCursor(layer, [oid_field, field]) as cursor:
        for row in cursor:
            selected_field.append(row[1])

    return selected_field

        

def run_workflow(path):
    """ This function calls all functions in the needed order to produce final output """

    scids = ['wv01', 'wv02', 'wv03', 'ge01', 'lg01', 'lg02', 'lg03', 'lg04']
    output_loc = path
    output_feature = output_loc + "\\Staging\\" + "Avanoa_test"
    
    # Get the active map document and data frame
    m = arcpy.mp.ArcGISProject("CURRENT").activeMap

    # Get the orders layer
    orders_layer = get_layer_by_name('active_orders_ufp_Avanoa', m)

    # Create lists of available orders for each spacecraft and add the order lists to a dictionary
    order_lists = dict()
    for scid in scids:

        # get the onv layer
        onv_layer = get_layer_by_name('onv_'+scid+'_Avanoa', m)
        
        # Select available orders for scid and put order ids in a list
        select_available_orders(orders_layer, onv_layer, scid)
        order_lists[scid] = get_selected(orders_layer, 'external_id')

        arcpy.AddMessage("Number of available orders on " + scid + ": " + str(len(order_lists[scid])))

    # Create a list of unique availabe order ids
    unique_ids = list(reduce(lambda x, y: set(x) | set(y), list(order_lists.values())))
    arcpy.AddMessage(str(unique_ids))

    # Create the new order layer
    arcpy.SelectLayerByAttribute_management(orders_layer, "CLEAR_SELECTION")
    arcpy.conversion.ExportFeatures(orders_layer, output_feature)

    
    # Create a columnn in a the output shapefile for number of accesses
        # Column calculation is the number of lists the order id is found in
# Create column specific vars
    field_name = "Accesses"
    expression = "Get_Number_of_Accesses(!external_i!)"
    field_type = "Short"
    code_block = "order_lists = " + str(order_lists) + """
def Get_Number_of_Accesses(order_id):
    count = 0
    for scid in order_lists:
        if order_id in order_lists[scid]: count+=1
    return count
            
            """
    arcpy.AddMessage(code_block)

    # Add column to feature class
    arcpy.management.CalculateField(output_feature, field_name, expression, "PYTHON3", code_block, field_type)


    ['016436902010', '017346529010', '200006039817', '046101709160', '016360404010', '046101723080', '017316170010', '046101741040', '046101759040', '046101734040', '016436720010', '017315613010', '016436552010', '046101742100', '016232423020', '016231670010', '200006099258', '016436537010', '046101752190', '200006099729', '046101740170', '046101728200', '046101751170', '046101747120', '017315646010', '017315023010', '017315906010', '017315894010', '017316079010', '046101759080', '017301537010', '016436915010', '046101762050', '016436595010', '016232018020', '017345303020', '046101766180', '017315648010', '017315514010', '200006099317', '016436744010', '017346320040', '017315910010', '046101765090', '200005896001', '046101767150', '046101741020', '016436743010', '017315528010', '046101738110', '016436749010', '016436714010', '017346534010', '017316131010', '200006060602', '017335708010', '046101737050', '046101737030', '046101726150', '017315015010', '046101719080', '017342625010', '017316144010', '017345631010', '046101703110', '016436523010', '017314489010', '200006099810', '017315002010', '046101701070', '017315631010', '200006099719', '046101707170', '046101714140', '046101699140', '046101757160', '017316093010', '017314312010', '017316201010', '046101761090', '017315529010', '017315602010', '016231940050', '016436414010', '016442308010', '016436543010', '016436601010', '017314320010', '046101705150', '017314351010', '046101758020', '017345311010', '017315895010', '017315642010', '017316173010', '016436721010', '017314997010', '017315903010', '046101698040', '017315026010', '200005945988', '200006099820', '017344732010', '017315925010', '046101712130', '200006099438', '046101717140', '200005945983', '017345609010', '016436522010', '016235195030', '200006039818', '200005945990', '046101722130', '046101696020', '017314318010', '016233022030', '017314345010', '017341534010', '017315512010', '200006099444', '016436540010', '017315905010', '017315505010', '017315018010', '016420276030', '046101723010', '016436752010', '017315039010', '016436978010', '200006099612', '016436731010', '016436556010', '046101720200', '046101705160', '200006056316', '017315662010', '017333183010', '016442343030', '017315889010', '017333188010', '046101702130', '017315538010', '017314460010', '017314999010', '046101728060', '016436561010', '016436981010', '016424702010', '017315930010', '200006099443', '046101714040', '017315004010', '017301549010', '200006099174', '200005945974', '200006099409', '017316075010', '017315546010', '017333174010', '016232772010', '200006099403', '017315591010', '017316157010', '017315883010', '046101700140', '046101763090', '017315884010', '200005945986', '200006099372', '046101718160', '017314343010', '017346250010', '016420277020', '016419162010', '200006099406', '046101725010', '046101754100', '017346297010', '017344862010', '017333175010', '017314480010', '046101696170', '046101710070', '017315675010', '200006099374', '200006039948', '046101728040', '017315917010', '017301375010', '017346251010', '017338642030', '016436939010', '046101765100', '017344942010', '046101708060', '200006039537', '017333169010', '046101694140', '017315515010', '046101695030', '017314458010', '017333179010', '016235004020', '017315674010', '017315032010', '200006065948', '200006060592', '046101741030', '017333159010', '017345620010', '200006099358', '046101719190', '016436588010', '017316146010', '016234834030', '017314466010', '200006099396', '200006099802', '017314502010', '017314498010', '017316164010', '046101741180', '017333182010', '200006099199', '046101720010', '016420277010', '016436583010', '046101765070', '046101716190', '200006060594', '017315614010', '017315020010', '046101745010', '200006099679', '046101763130', '046101757050', '200006099721', '046101721120', '046101743080', '017346535010', '016436518010', '046101709200', '046101732030', '016436524010', '200006099363', '016232642040', '016436992010', '046101754110', '016436716010', '016232136050', '046101706010', '017316076010', '017315670010', '016436590010', '017315008010', '017315603010', '200006060585', '016440181010', '016436557010', '016436596010', '046101728080', '016234608050', '017315934010', '046101733060', '017315918010', '016231910010', '017315912010', '017333186010', '046101697170', '017315029010', '046101769170', '017314469010', '017314474010', '016232133030', '046101702080', '016436753010', '046101742080', '046101723120', '017315888010', '017314317010', '017301583010', '200006039200', '017301593010', '016232375030', '046101747190', '046101763020', '046101698050', '017316120010', '016424800010', '046101698090', '016436764010', '046101733070', '017315615010', '016436740010', '046101754070', '017315676010', '200006060589', '046101699010', '046101710200', '016436989010', '017341738020', '200006099451', '017315556010', '017315914010', '016436562010', '017315893010', '017315873010', '046101769200', '017316159010', '017314465010', '046101747180', '017314350010', '200006039752', '017333163010', '017335199040', '200006099345', '016436768010', '017315511010', '016440182010', '046101712030', '046101750180', '046101733080', '016436747010', '017315611010', '016424701010', '017315555010', '200006099386', '017315650010', '017314353010', '017315548010', '016436514010', '017316143010', '017341738040', '017315521010', '017346320020', '016233444040', '200006099774', '046101716020', '046101704130', '046101765130', '046101718170', '016436594010', '016436717010', '046101721110', '046101712140', '016436515010', '046101757070', '200006099879', '200006099824', '046101733190', '017345618010', '046101694060', '017346321070', '046101757090', '200006039437', '016436650010', '017316092010', '200006099908', '200006099427', '017315547010', '200006039959', '016436563010', '017315663010', '200006099706', '017315553010', '017315013010', '016436600010', '046101701130', '046101753100', '046101731050', '017316149010', '016420276010', '046101720180', '017315518010', '017316139010', '016440213010', '046101701080', '017316090010', '200006099321', '017341738050', '017315628010', '016442312010', '016436980010', '017315552010', '017316127010', '200006099416', '016436741010', '046101714150', '016232009030', '200006099886', '046101753180', '046101756010', '017315597010', '046101731030', '017333170010', '046101760120', '016436573010', '017315557010', '046101701170', '016233534030', '046101740090', '016234722050', '200006099398', '200006099422', '016235190040', '200006099397', '017315560010', '016232622050', '017316147010', '017315596010', '016436571010', '046101759190', '046101726160', '200006099643', '016436575010', '046101755050', '016436581010', '200006099349', '046101769090', '016233334020', '017315660010', '016436582010', '046101712150', '016436927010', '017315880010', '017314457010', '017345266010', '017315885010', '200006099263', '046101727040', '017315542010', '016232344050', '046101738010', '017346321040', '046101728130', '016436766010', '046101694050', '046101762200', '016436598010', '200006039942', '017345632010', '017315639010', '016436531010', '046101760090', '017315595010', '046101769060', '017314362010', '046101730180', '200005896004', '017316160010', '046101697200', '017346307010', '017314319010', '046101701200', '017315561010', '046101754140', '017315896010', '046101716180', '017315878010', '016436603010', '046101724200', '200006039201', '046101754010', '017315644010', '017314482010', '017344349060', '046101729040', '046101731010', '016436950010', '016436519010', '016436770010', '200006039265', '017316140010', '017316165010', '016233455030', '017345628010', '046101728120', '200006099161', '200006099726', '017315025010', '046101723110', '200006039827', '200005945991', '017346528010', '017316134010', '017314401010', '016436542010', '016436755010', '046101764140', '017315890010', '016232887050', '046101733180', '017314473010', '046101701180', '046101766140', '017346303010', '200006099448', '016436712010', '017315608010', '017341673010', '046101721070', '017346320070', '017315862010', '046101709070', '017333173010', '200006099842', '017315664010', '046101717060', '200006099623', '200006099230', '017335708070', '046101722160', '017315667010', '017315891010', '017315593010', '046101728110', '046101722190', '017315641010', '016232180010', '017316125010', '017346461010', '200006099704', '017334680050', '016420277040', '200006099450', '017340486010', '046101716200', '200006039203', '017315563010', '016436584010', '017314356010', '016436417010', '016424796010', '017314316010', '017316089010', '016436928010', '046101715200', '016436722010', '046101737070', '017315882010', '016436558010', '046101694040', '016436559010', '046101703070', '017316103010', '017339183080', '046101750100', '200006039751', '016424794010', '017316073010', '016232051040', '017315508010', '200006039559', '016436718010', '046101759060', '200006039291', '046101705130', '016436634010', '017344939010', '046101726030', '200006060597', '017314315010', '046101713040', '200006099215', '046101751150', '016436943010', '016436550010', '046101759170', '046101745050', '016436931010', '016442299010', '017333165010', '046101730200', '017346486010', '046101696180', '016436732010', '017314493010', '017315040010', '046101707160', '200006099328', '200006039263', '016436585010', '017316102010', '016436569010', '017316122010', '017315669010', '046101731190', '016436956010', '046101696160', '200006099867', '016442303010', '017315601010', '016436529010', '017301367010', '046101699090', '017301374010', '016436551010', '046101733090', '017315661010', '016436750010', '016436553010', '200006099340', '200006039415', '046101758040', '200005945993', '017346532010', '016436645010', '017333172010', '017315033010', '200005945992', '016232266030', '046101700080', '017333160010', '200005945972', '017315864010', '200006099749', '017342628010', '016436541010', '046101727030', '200006099445', '046101758080', '017333168010', '016436533010', '200006060598', '046101769040', '200006099370', '046101722080', '017345626010', '016436538010', '017314492010', '046101739050', '017333150010', '016436580010', '016436574010', '200006099808', '016436991010', '016436586010', '016436982010', '046101709080', '046101740200', '046101736170', '046101734070', '016436591010', '017346347010', '017301368010', '016235137010', '200006099344', '017314491010', '016436419010', '046101717130', '046101725070', '200006039183', '046101741050', '017316203010', '046101694090', '200006071504', '017314344010', '016436570010', '200006099259', '046101754040', '200006099155', '017314500010', '046101758100', '016436572010', '200006099723', '017316163010', '017316133010', '017346321020', '046101722050', '017315031010', '046101762090', '017301602010', '200006099777', '046101730190', '017314496010', '046101732010', '200006099882', '200006099281', '017315000010', '017344730010', '016231958030', '046101740180', '017315887010', '016436745010', '046101701090', '046101716080', '017316101010', '046101719130', '046101730120', '017316135010', '200006060590', '016233502010', '016436566010', '016232058020', '016436629010', '017344693010', '017314501010', '200006099293', '046101732200', '016424784010', '046101714050', '017315680010', '016436411010', '046101756020', '017314478010', '017315605010', '017301361010', '016442343010', '016436587010', '200006099718', '017333178010', '017301546010', '200006099762', '046101752120', '017316200010', '017346141010', '016411042010', '200006039217', '017315875010', '017316172010', '200006099172', '017316145010', '017316087010', '200006099890', '016436547010', '046101750200', '046101724140', '016436990010', '200006060606', '016436554010', '046101732120', '200005945978', '046101750060', '017314485010', '017314486010', '017314464010', '046101747130', '200006099827', '016436648010', '200006099446', '017315665010', '017315554010', '017316195010', '016436415010', '017315927010', '200006099323', '046101721030', '046101748170', '046101742020', '046101762030', '046101755070', '046101725030', '016235051010', '017316080010', '017315907010', '016436737010', '017314481010', '016232410030', '017315915010', '017314471010', '016436528010', '046101722060', '046101712080', '200006099751', '017344731010', '017315501010', '046101714090', '016436567010', '200006099400', '017314488010', '017346371010', '016436736010', '017315600010', '046101695040', '016436564010', '046101723170', '017316141010', '016436746010', '017314499010', '200006039963', '017333184010', '200006099423', '017316199010', '046101764010', '017316190010', '017316094010', '046101719150', '017342342010', '017346473010', '017314361010', '016436539010', '016436979010', '016436526010', '046101709050', '017315874010', '016234835040', '046101739090', '016424707010', '016436592010', '016233111020', '046101764040', '200006039487', '200006099850', '017315037010', '017346527010', '017315632010', '017315034010', '200006099724', '046101714100', '046101718130', '017315645010', '046101706170', '046101721090', '016436412010', '017316100010', '017316162010', '200006099294', '017315647010', '017346458010', '046101721020', '016436578010', '046101699110', '046101766190', '046101769110', '016309176010', '017314346010', '046101727010', '016436532010', '200006056309', '017315017010', '046101734140', '200006099280', '046101747030', '017315637010', '017315668010', '016436545010', '017315005010', '017316202010', '046101769180', '016436742010', '017314487010', '017315012010', '046101724150', '017315010010', '016436977010', '017315679010', '017301540010', '046101754130', '200006039468', '017315011010', '017316198010', '017333167010', '017344729010', '017316081010', '017346321050', '017315007010', '016436546010', '017315861010', '017315598010', '017301555010', '046101744060', '200006099460', '017346346010', '046101751160', '017316150010', '017314490010', '200006099883', '017315616010', '017316191010', '046101728100', '017315024010', '017315590010', '017315562010', '016436535010', '046101758110', '200006099753', '046101728160', '046101758090', '017315544010', '017346320050', '046101705030', '046101745140', '200006099319', '017333187010', '046101727050', '017315559010', '200006099710', '017301586010', '016436534010', '046101705200', '046101761170', '046101751110', '016436916010', '017315666010', '017315588010', '046101704170', '046101717110', '200006099417', '016232665030', '017346321010', '017333161010', '016436632010', '017346419010', '200006039760', '046101730130', '046101749050', '016231861040', '046101760110', '046101699130', '017342626010', '200006099169', '200006099394', '017345622010', '046101728170', '017344349010', '017315594010', '046101725170', '046101703120', '017315587010', '016233290050', '046101709040', '046101740010', '017315866010', '046101740120', '016436728010', '016436757010', '046101724190', '016436748010', '046101740070', '017315886010', '200006060583', '017315863010', '016436416010', '016436565010', '200006099408', '016234728020', '046101702050', '200006099392', '046101728070', '046101736010', '017346321060', '046101751070', '046101713200', '046101696090', '200006099859', '016436987010', '046101707080', '200006099339', '046101769100', '017315653010', '046101719060', '046101746110', '016436945010', '046101706050', '016436911010', '200006099892', '017314475010', '200006099207', '200006099452', '017314479010', '046101765140', '046101767090', '017315551010', '046101702030', '016436985010', '016436988010', '016226103010', '046101755030', '046101700010', '046101767080', '017315673010', '046101727060', '046101739070', '046101707150', '016234750040', '016436549010', '017315623010', '017315643010', '200006099310', '016436525010', '200006099354', '200006099225', '200006099426', '017316204010', '200006039947', '017346459010', '017340487010', '016436724010', '016436715010', '017338277030', '017346151010', '200006056313', '017315525010', '016436536010', '016436530010', '017315516010', '017315006010', '016436577010', '200006099338', '016436516010', '017315626010', '046101722070', '017346320010', '016436754010', '046101714070', '017333162010', '017333176010', '046101711040', '017315599010', '046101731160', '016313816020', '046101759160', '046101733150', '017346460010', '016436647010', '017315001010', '046101756060', '200006099698', '017315881010', '016436954010', '046101712170', '017316099010', '200006099439', '200005945970', '046101718120', '017333156010', '046101712160', '046101765150', '046101761110', '200006099222', '017344726010', '017315898010', '200006099744', '046101717010', '017344349040', '046101758030', '017314313010', '046101700170', '017315902010', '017315604010', '017315624010', '016233086030', '017316153010', '046101715170', '046101756080', '017344728010', '017315877010', '017314476010', '200005945979', '016424788010', '016424789010', '016429997030', '200006099382', '200006039735', '200006099767', '046101720170', '017315513010', '200006039214', '016436751010', '017315036010', '017346321030', '017314467010', '046101717150', '016436422010', '017315541010', '016436756010', '016436548010', '017315565010', '046101713030', '016436520010', '017315681010', '200005945973', '017340372010', '046101753160', '016436560010', '046101697020', '016355377040', '046101705190', '200006099665', '017341738060', '017333151010', '017315021010', '017316130010', '017316072010', '046101751060', '017314484010', '200006099404', '200006058582', '017316091010', '016436952010', '017346145010', '017315027010', '200006099189', '046101718050', '200006099852', '200006099861', '017315028010', '017315019010', '017314998010', '017346536010', '017316132010', '046101702060', '200006099829', '046101702040', '046101740190', '046101714060', '017315016010', '046101762190', '200006099637', '200006099435', '046101734100', '046101729060', '017333158010', '046101767100', '016441932020', '200006039223', '017314314010', '200006060591', '017346150010', '200006099666', '016436739010', '016436901010', '017301371010', '017315533010', '017344870010', '017315041010', '016436976010', '046101712010', '016436427010', '046101696060', '017315022010', '046101718040', '046101759010', '046101729010', '017315592010', '016436555010', '016436527010', '200006099183', '017315014010', '017316192010', '017315638010', '016235449030', '017333164010', '017314494010', '046101744120', '017314477010', '016436719010', '017315649010', '017315570010', '046101755100', '200006099747', '016436568010', '017314483010', '016436723010', '046101747150', '046101740160', '017333155010', '046101713130', '046101752030', '046101724120', '200006039174', '046101763060', '016231726010', '017345616010', '017315622010', '046101698200', '200006099154', '017333166010', '017315636010', '017315654010', '046101726170', '017315030010', '017316171010', '017315635010', '016231811010', '046101722030', '200006099709', '200006099858', '016436738010', '017315609010', '200006056310', '200006099677', '017315506010', '017315522010', '017346537010', '017342343010', '016232154030', '046101758140', '017315876010', '200006039950', '200005896007', '017315520010', '017315558010', '017315612010', '017315531010', '017346457010', '017342344010', '016442347010', '017314472010', '017346531010', '046101694150', '046101756150', '016420276040', '016436630010', '200006060582', '046101705100', '017316128010', '017315009010', '016436517010', '046101744110', '017301588010', '046101741200', '017346320030', '046101759180', '017314495010', '017316077010', '046101746190', '046101712070', '017314341010', '017333180010', '200006039949', '046101762140', '017316169010', '017316129010', '200006099160', '017315543010', '016436602010', '016440209010', '200006099434', '046101730010', '016436940010', '200006099290', '200006099803', '046101724180', '016436589010', '046101746100', '017333171010', '046101722200', '016436521010', '017301600010', '046101763150', '046101767170', '017316086010', '017315619010', '016438434010', '200006099163', '016436713010', '046101700100', '046101723160', '017315504010', '017342345010', '046101705020', '200005945971', '017346538010', '017333185010', '200005895997', '046101705180', '017315564010', '017342346010', '016436576010', '017301538010', '017342627010', '046101738100', '017314461010', '046101716050', '016232593030', '017301363010', '016436599010', '017315035010', '046101759200', '046101731120', '017316183010', '046101731150', '046101733100', '046101765170', '200006099765', '017301576010', '200006039566', '046101699080', '200006099361', '017314463010', '046101737100', '046101739110', '046101742060', '046101743170', '046101695200', '016231841010', '017316158010', '046101750040', '016436544010', '016233315020', '017315540010', '016232894010', '200005945968', '200006099240', '200006099296', '017316161010', '046101716090', '016436725010', '017314470010', '046101719140', '017335199070', '017333157010', '016436579010', '017315633010', '017301557010', '016436597010', '046101742090', '017314468010', '016436420010', '017315527010', '046101722040', '017316098010', '016419161010', '046101751050', '200006099285', '046101720150', '017315524010', '017333177010', '016441932010', '200006099362', '046101700200', '016235162010', '046101750120', '017316085010', '017315617010', '046101710120', '046101698120', '046101756030', '017342351010', '200005945984', '016232606010', '200006099205', '046101701060', '046101759050', '046101718180', '016234778020', '200006039820', '046101744020', '046101702150', '017315671010', '046101752200', '046101765080', '200006099297', '017344727010', '017316156010', '017333181010', '016232357010', '046101729050', '017341004010', '016436593010', '017345615010', '200006039281', '046101767110', '046101761080', '046101722010', '017315640010', '016436730010', '200006099371', '017344349070', '046101700190', '046101752170', '046101701120', '017316194010', '017316074010', '046101717090', '046101714160']
order_lists = {
'wv01': ['046101750060', '046101733060', '046101747180', '046101733180', '046101737100', '017346527010', '046101734070', '046101750180', '046101744120', '046101740090', '046101740190', '046101736010', '046101732010', '046101740160', '046101741020', '017346251010', '016441932020', '046101733080', '017346535010', '046101733090', '046101741050', '046101736170', '046101732030', '046101750040', '046101733190', '046101738110', '046101738010', '017346145010', '046101739090', '046101746190', '046101741180', '046101734140', '046101732120', '046101742060', '046101743170', '046101742020', '046101748170', '017342625010', '046101741030', '046101732200', '046101745140', '046101744020', '046101741040', '017346346010', '046101742090', '046101750200', '017346473010', '046101744060', '017346528010', '046101750120', '046101739070', '046101737030', '046101745050', '046101740010', '046101733100', '046101740200', '046101747030', '046101734040', '017342626010', '046101740070', '046101733150', '046101747130', '046101749050', '046101739110', '046101740120', '046101743080', '046101742080', '017346532010', '046101733070', '046101747190', '046101742100', '046101740170', '046101737070', '046101746100', '017341673010', '046101747120', '046101744110', '046101741200', '046101746110', '017346529010', '046101738100', '046101739050', '017341534010', '046101734100', '046101747150', '017346531010', '046101740180', '046101750100', '017346150010', '046101745010', '046101737050'], 
'wv02': ['017315638010', '017344942010', '016436590010', '017314494010', '016436551010', '017315662010', '016436559010', '016436716010', '046101730200', '017315040010', '016436757010', '017333185010', '016436516010', '016436745010', '017342628010', '017333150010', '017315666010', '017315035010', '046101719190', '017314490010', '017314460010', '017315025010', '046101720010', '017346527010', '017314351010', '017346321010', '016436564010', '016436740010', '017346320040', '046101719140', '016436586010', '046101722080', '016436569010', '016436524010', '046101731190', '046101726160', '017314493010', '017314502010', '016436601010', '046101729040', '046101727010', '016436577010', '046101726150', '016436545010', '016440213010', '017344862010', '046101714090', '017346321060', '017315915010', '016436534010', '016436549010', '017314466010', '016440209010', '016436557010', '046101718170', '016436522010', '017314486010', '017315668010', '017315663010', '046101727040', '016436585010', '016436556010', '016436752010', '016436414010', '017314478010', '016436539010', '046101731030', '017315015010', '017315665010', '046101718120', '017333180010', '016436712010', '046101722160', '046101724150', '016436744010', '016436416010', '046101718130', '017315029010', '046101717110', '017314998010', '016436770010', '016436591010', '017315667010', '017333156010', '016436630010', '016436544010', '016436411010', '016436528010', '017315906010', '016436634010', '016436563010', '046101731120', '017333172010', '017315632010', '017333179010', '017315017010', '017315633010', '046101728160', '017314484010', '017345628010', '016436583010', '017346307010', '017333165010', '017333155010', '016436747010', '017315012010', '046101723160', '016436629010', '046101717130', '017345632010', '017333164010', '017315591010', '017346535010', '017314475010', '017315018010', '046101722190', '017315037010', '017341004010', '016436568010', '046101722010', '046101725070', '016436750010', '017314463010', '046101731010', '017333174010', '017315026010', '016436538010', '016436650010', '017315008010', '016436748010', '046101716080', '017341738060', '017333163010', '017315005010', '017314488010', '016436567010', '046101731160', '016436533010', '046101726170', '016436548010', '016436723010', '017315027010', '017315024010', '017315013010', '016440181010', '046101730120', '016436749010', '017315643010', '017346145010', '046101731050', '046101714160', '046101722050', '016436768010', '046101717090', '016436537010', '016436531010', '046101720170', '046101719150', '017315587010', '046101722030', '017315646010', '016436720010', '016420276010', '016436555010', '016436743010', '017314489010', '017342627010', '046101716190', '017315611010', '017333166010', '016436731010', '017315903010', '016436417010', '017315648010', '016442303010', '017333173010', '017314476010', '017333187010', '016436536010', '016436725010', '017345616010', '017315905010', '017315000010', '046101715200', '016436754010', '017333162010', '046101717140', '046101724120', '017314480010', '017314344010', '016436523010', '046101728060', '046101731150', '017315036010', '017315912010', '016420277010', '016436715010', '017344349010', '017315918010', '046101722060', '017314467010', '016436546010', '017315914010', '046101713130', '016436415010', '017315671010', '016436543010', '017333158010', '016436739010', '017338642030', '017315011010', '017315907010', '046101714040', '046101722200', '046101728200', '016436721010', '017315009010', '046101713200', '017314501010', '016436592010', '016436756010', '016436412010', '017333161010', '046101725170', '016436594010', '016436422010', '017314468010', '046101727060', '017314312010', '016436575010', '017315598010', '017315664010', '046101723110', '016436565010', '017315023010', '017341738050', '016436518010', '017333160010', '017315602010', '017314496010', '016436562010', '016436587010', '046101724190', '016436746010', '017346320010', '046101721020', '046101717010', '017315593010', '046101716200', '017315588010', '017315020010', '017333157010', '016436730010', '016436732010', '016436645010', '017315006010', '046101718180', '017333168010', '046101728080', '017333169010', '016420276030', '017346473010', '017314481010', '016436560010', '016436736010', '016436529010', '017340372010', '016436514010', '046101730180', '017314345010', '017333181010', '017314997010', '017346528010', '016436579010', '017315031010', '016436517010', '016436598010', '016436588010', '046101728120', '016424800010', '046101716020', '017314353010', '017315601010', '016436552010', '017314316010', '017314315010', '017344939010', '017315565010', '017315002010', '046101713040', '046101717060', '046101728110', '017314465010', '016436540010', '016436717010', '016436632010', '017314477010', '017314469010', '016436535010', '046101727050', '016436515010', '016436600010', '016436753010', '016436566010', '016436603010', '016436738010', '046101730130', '017315640010', '016436728010', '016436751010', '016360404010', '017315599010', '016436578010', '017314461010', '017314314010', '016424794010', '046101728070', '046101719130', '017314320010', '046101724180', '017345618010', '016436541010', '016436597010', '017315600010', '017333182010', '017333175010', '017314361010', '017314464010', '017333186010', '016436582010', '017345311010', '017315041010', '017345615010', '046101716180', '046101725010', '016424707010', '017314317010', '017315019010', '017315004010', '046101723170', '017346320030', '046101717150', '016436526010', '017315604010', '017315570010', '016436530010', '016436571010', '046101728130', '017314483010', '017315016010', '017314401010', '016442308010', '016436542010', '046101729010', '016436724010', '016436427010', '017315639010', '017345609010', '046101721030', '017314346010', '017314500010', '046101722070', '017315594010', '046101723120', '017345620010', '017315596010', '016436553010', '016436602010', '017314319010', '046101714100', '016436722010', '016436521010', '017315910010', '016436648010', '017314495010', '017344349040', '017315592010', '017314487010', '017314485010', '017314350010', '017315644010', '017345622010', '017341738040', '017315660010', '046101720150', '016436718010', '016436742010', '016436532010', '016436755010', '017315636010', '017346320050', '017315590010', '016436519010', '017314362010', '017315007010', '046101719060', '017346371010', '046101722130', '046101729060', '016436580010', '016355377040', '046101723010', '016424701010', '017346534010', '017315645010', '016436737010', '017315917010', '017315010010', '017315603010', '046101722040', '046101726030', '046101714060', '017314473010', '017333167010', '017314341010', '017346320020', '016436561010', '016436764010', '046101718160', '046101728100', '017315925010', '017315637010', '017345626010', '016436599010', '017315595010', '017315612010', '017333183010', '017333176010', '046101724200', '016436547010', '046101719080', '017315649010', '046101724140', '017314479010', '017314482010', '017346320070', '017314474010', '017314356010', '046101725030', '016420276040', '046101716090', '017345631010', '017333184010', '016436570010', '017315030010', '017344349060', '046101716050', '046101730010', '016436572010', '017315641010', '046101720180', '017333177010', '017315631010', '016436576010', '017314471010', '016436550010', '016436520010', '017314472010', '016436420010', '046101727030', '046101718050', '016436595010', '017315661010', '016436574010', '017315597010', '016436766010', '017315674010', '017314457010', '017346321050', '016436596010', '016436719010', '046101729050', '016436573010', '017315669010', '046101714050', '046101713030', '046101714070', '016442299010', '017333171010', '017314343010', '046101728170', '016424788010', '016436554010', '017333178010', '046101718040', '046101714140', '046101721120', '017346531010', '046101730190', '017333151010', '016436589010', '016436558010', '046101721110', '016436419010', '017314318010', '016436714010', '016420277020', '016436741010', '017301367010', '017314313010', '017315642010', '017315001010', '017314458010', '016436581010', '017315032010', '017314491010', '017315028010', '017315021010', '017333188010', '017333170010', '046101728040', '046101714150', '017315635010', '046101721070', '016436647010', '017314492010', '017315034010', '046101720200', '016442312010', '017333159010', '016436527010', '017314470010', '016436593010', '016436584010', '016436713010', '046101721090', '046101723080', '017314499010', '017314498010', '017344870010', '046101715170', '017314999010', '017315039010', '017342343010', '017315033010', '017338277030', '017334680050', '017315628010', '017315014010', '016436525010', '017315650010', '017315022010'], 
'wv03': ['017314494010', '046101712080', '046101705130', '016231910010', '016232887050', '017301375010', '016419161010', '017315653010', '046101699110', '046101712160', '017333185010', '017315541010', '017333150010', '017315552010', '046101695040', '046101712010', '016232266030', '016234722050', '016232622050', '017314490010', '046101699090', '017314460010', '017315560010', '017341738020', '017315608010', '017335708070', '017314351010', '017315520010', '046101702080', '017346321010', '046101696170', '046101709200', '016231940050', '017346320040', '017345303020', '046101704170', '016235449030', '046101707160', '017314493010', '016232357010', '017314502010', '017315558010', '017301546010', '017315605010', '046101707080', '017346321060', '017315927010', '017314466010', '016440209010', '017314486010', '017301583010', '016232772010', '046101702150', '017315554010', '017315619010', '017346536010', '046101698040', '017314478010', '016233111020', '017333180010', '016231958030', '046101705200', '017315609010', '046101702130', '017301593010', '017333156010', '046101710120', '046101704130', '017333172010', '017333179010', '046101709050', '017314484010', '017345628010', '017346307010', '046101703070', '017333165010', '046101695030', '017333155010', '046101698090', '016233455030', '046101699140', '017345632010', '046101696020', '046101705020', '016231811010', '016424796010', '016232665030', '017333164010', '017346457010', '046101701130', '017315647010', '017314475010', '046101712030', '017341004010', '046101697020', '017315553010', '017314463010', '017346321040', '016232133030', '046101711040', '017333174010', '016232180010', '017341738060', '017333163010', '016234778020', '017314488010', '017315524010', '046101702060', '017301537010', '046101705100', '046101698120', '046101700170', '016233334020', '016411042010', '046101701070', '046101708060', '046101696090', '016420276010', '017314489010', '016313816020', '017315615010', '017333166010', '016234608050', '017315542010', '017315562010', '017333173010', '017346459010', '017315512010', '017314476010', '046101712140', '016232009030', '017346537010', '017333187010', '016235190040', '046101705190', '017345616010', '016235195030', '017315547010', '017315616010', '017333162010', '017315504010', '016234835040', '017314480010', '017315613010', '046101694060', '016420277010', '016234834030', '017344349010', '017315918010', '017314467010', '017346458010', '017315930010', '016429997030', '017333158010', '046101712130', '017338642030', '016232154030', '016235162010', '017315623010', '046101701200', '017314501010', '016233315020', '017333161010', '017301576010', '017315518010', '017314468010', '017314312010', '046101696060', '017315557010', '046101709040', '017341738050', '017333160010', '017314496010', '046101709080', '017346320010', '017315559010', '017301557010', '017315564010', '017315555010', '017315626010', '017333157010', '017315617010', '016232423020', '016232344050', '017333168010', '017333169010', '016233086030', '016420276030', '017314481010', '016233022030', '017301600010', '046101705160', '017315538010', '017340372010', '046101702040', '017333181010', '017315513010', '046101698050', '046101700200', '017314353010', '017314316010', '017314315010', '016232410030', '017314465010', '046101712170', '046101696160', '017314477010', '017314469010', '046101709070', '017315506010', '046101701090', '017315543010', '046101705150', '017315614010', '016231841010', '017301588010', '017314461010', '017314314010', '046101701060', '016232051040', '017315540010', '017314320010', '017345618010', '046101698200', '016232136050', '017333182010', '017333175010', '017314361010', '017314464010', '017333186010', '017301538010', '046101706050', '017345311010', '016231726010', '016309176010', '017345615010', '046101702030', '046101701080', '016232018020', '016231670010', '017314317010', '046101706010', '017346320030', '046101703120', '046101694090', '046101710200', '016232375030', '017314483010', '046101699130', '017315522010', '017314401010', '016232058020', '017342346010', '017315516010', '017315544010', '046101697200', '017345609010', '017301602010', '017314500010', '046101694150', '017345620010', '017315531010', '017301555010', '046101700080', '017314319010', '046101699080', '046101699010', '017315910010', '017314495010', '016233444040', '017344349040', '046101700100', '016234750040', '017314487010', '017314485010', '017314350010', '017345622010', '046101701120', '017341738040', '046101696180', '016235004020', '046101695200', '046101694050', '017346320050', '046101709160', '046101705030', '046101706170', '017314362010', '017346371010', '017301549010', '016355377040', '046101694140', '046101701170', '017315917010', '017314473010', '017333167010', '016232642040', '017315563010', '017346320020', '017345626010', '017315521010', '016232894010', '016233534030', '017333183010', '017333176010', '017315561010', '017346321020', '017314479010', '017314482010', '017346320070', '016235051010', '017315551010', '017314474010', '017314356010', '016420276040', '017301361010', '046101701180', '017315511010', '017345631010', '017333184010', '046101710070', '046101700010', '046101700140', '017344349060', '016232606010', '017315528010', '017333177010', '017315624010', '017315556010', '046101712070', '017314471010', '046101694040', '016232593030', '017314472010', '046101697170', '017315501010', '016233290050', '046101707150', '017301586010', '017315548010', '017314457010', '017346321050', '017315654010', '017315505010', '017301368010', '017315546010', '017333171010', '046101705180', '046101700190', '017333178010', '017315533010', '046101712150', '017333151010', '046101702050', '016235137010', '017314318010', '016420277020', '017301367010', '017301371010', '016440182010', '017314313010', '016234728020', '017315508010', '017315527010', '017301374010', '017314458010', '016233502010', '017314491010', '017301540010', '017333188010', '017333170010', '016231861040', '017315514010', '017346460010', '017346538010', '017314492010', '017315529010', '017333159010', '017314470010', '046101707170', '017314499010', '017315934010', '017314498010', '017346303010', '017301363010', '046101703110', '017315525010', '017338277030', '017334680050', '017315622010', '017315515010'], 
'ge01': ['017316192010', '017316072010', '017316200010', '017316081010', '046101761080', '017346297010', '046101761110', '046101756030', '016226103010', '017339183080', '017316074010', '017315864010', '046101754110', '046101762140', '017342345010', '017316164010', '017315895010', '016419162010', '017346486010', '046101754040', '046101765130', '046101755100', '017316169010', '046101765100', '017316202010', '046101756020', '046101754070', '017316090010', '017344730010', '017335199040', '017346151010', '016436990010', '046101763090', '046101759040', '046101751110', '017316147010', '016436928010', '046101760120', '016436902010', '046101754010', '017316102010', '017316076010', '017315884010', '046101759060', '017316129010', '017315876010', '016424702010', '046101758080', '046101759200', '046101765170', '017315680010', '017342344010', '017346321070', '046101751160', '017315880010', '017315893010', '017315898010', '017346251010', '016441932020', '046101769100', '016436981010', '017316101010', '017316130010', '017316127010', '017316098010', '017315902010', '046101759160', '046101767100', '016436940010', '017346141010', '017316191010', '046101758110', '046101769170', '046101769040', '016436939010', '017315881010', '017335708010', '046101757090', '046101763130', '017315883010', '046101761090', '046101756080', '017315890010', '046101752030', '016442347010', '046101758040', '046101755030', '046101762050', '046101759080', '016441932010', '016436985010', '046101766180', '046101769060', '046101755050', '016436980010', '017316199010', '017316173010', '017316159010', '046101758020', '046101769180', '046101756060', '046101765070', '046101758090', '046101756010', '016436978010', '046101751060', '017315894010', '017316080010', '017316075010', '017316156010', '017315670010', '017316171010', '016436956010', '017316128010', '046101759010', '046101769110', '017316085010', '017316140010', '017316133010', '016436943010', '017315873010', '017316145010', '046101766190', '017316146010', '017342625010', '046101765090', '046101753100', '017316120010', '017316163010', '046101754100', '017316091010', '017315874010', '017315861010', '016436950010', '016424784010', '016436982010', '017316170010', '046101764140', '046101762200', '017316153010', '017316198010', '017344349070', '016436987010', '017345266010', '017315675010', '016438434010', '017342342010', '046101762090', '016436945010', '017316122010', '017344693010', '046101754130', '017316103010', '016436911010', '017316157010', '017316201010', '046101757050', '017315673010', '046101752170', '017346528010', '046101764010', '046101765080', '046101759170', '046101763150', '016436976010', '017344726010', '016436988010', '046101751170', '017315887010', '017315866010', '046101761170', '017316134010', '046101759190', '017335199070', '017344727010', '016436927010', '016436954010', '017315877010', '017315676010', '046101763060', '016436977010', '046101758100', '017315891010', '017316183010', '017316144010', '017315885010', '017315889010', '017342626010', '017316195010', '046101760090', '017344731010', '046101757160', '046101752190', '016436916010', '017346419010', '017316093010', '017315681010', '046101760110', '046101765140', '046101767150', '017342351010', '017316132010', '016424789010', '017315863010', '017316087010', '046101753160', '017316150010', '017316077010', '017315896010', '017346532010', '046101763020', '016436952010', '046101767110', '017346250010', '046101767170', '046101767080', '017341673010', '017316158010', '046101752200', '017316092010', '046101759050', '046101752120', '046101751070', '017315679010', '046101769090', '017340487010', '017346321030', '046101751050', '017316143010', '017316161010', '046101758140', '017316125010', '017344728010', '016436992010', '017346529010', '016436991010', '017315875010', '046101762030', '046101767090', '017316086010', '017316160010', '046101759180', '017315882010', '017316190010', '017316135010', '046101757070', '017316099010', '017315888010', '017341534010', '016442343010', '017316100010', '046101762190', '017316162010', '046101765150', '016436915010', '017344732010', '046101756150', '017315862010', '017340486010', '017316131010', '017316204010', '017316089010', '046101758030', '046101754140', '017316139010', '016420277040', '046101769200', '017316149010', '017316172010', '016436901010', '017315878010', '016442343030', '017316094010', '017316194010', '017316165010', '016436931010', '017346461010', '016436989010', '017315886010', '046101755070', '017316079010', '017316073010', '017316141010', '046101751150', '017344729010', '017316203010', '016436979010', '017346347010', '017346150010', '046101753180', '046101764040', '046101766140'], 
'lg01': ['200006099358', '200006099154', '200006099280', '200006099434', '200005896001', '200006099172', '200006099382', '200006099448', '200005895997', '200006099372', '200006099258', '200006039214', '200006099317', '200006099344', '200006099296', '200006099294', '200006099423', '200006099215', '200006039223', '200006039437', '200006039735', '200006099400', '200006099404', '200006099339', '200006099443', '200006099427', '200006099397', '200006099398', '200006099259', '200006099444', '200006099340', '200006099409', '200006099403', '200006099386', '200006099297', '200006099416', '200006099285', '200006099374', '200006099451', '200006056310', '200006099445', '200006039827', '200006099446', '200006039817', '200006099207', '200006099392', '200006099349', '200006039217', '200006099169', '200006039752', '200006099362', '200006039487', '200006099460', '200006099281', '200006039820', '200006099435', '200006099438', '200006099370', '200006039818', '200006099345', '200006039174', '200006056316', '200006099183', '200006099174', '200006039183', '200006039760', '200006039751', '200006099230', '200006099321', '200006099371', '200006039203', '200006099394', '200006099205', '200006039468', '200006099406', '200006099160', '200006099225', '200006056309', '200006099328', '200006099408', '200006099426', '200006099323', '200006099450', '200006099189', '200006099422', '200006039415', '200006099338', '200006099319', '200006099354', '200006099396', '200006099310', '200006099363', '200006099361', '200006099199', '200006099163', '200006099222', '200006099417', '200006071504', '200006099240', '200006099155', '200006039200', '200006099263', '200006099161', '200006039201', '200006099439', '200006099452', '200006056313', '200006099293', '200006099290'], 
'lg02': ['200006099886', '200006039948', '200006099858', '200006099842', '200006099774', '200006099665', '200006099767', '200006099666', '200006060591', '200006060589', '200006099623', '200006099890', '200006099852', '200006099850', '200006039942', '200006039291', '200006060590', '200006099810', '200006099808', '200006039947', '200006099867', '200006099908', '200006099827', '200006099724', '200006060598', '200006099892', '200006039559', '200006060582', '200006039281', '200006060597', '200006099802', '200006099879', '200006099643', '200006039566', '200006099709', '200005896007', '200006099765', '200006099824', '200006099744', '200006039265', '200006099749', '200006099637', '200005896004', '200006099706', '200006099679', '200006099762', '200006099718', '200006099777', '200006060606', '200006039263', '200006099861', '200006099612', '200006099883', '200006060585', '200006099829', '200006099803', '200006099726', '200006099721', '200006060583', '200006039537', '200006039963', '200006099753', '200006099710', '200006099751', '200006060594', '200006039949', '200006099677', '200006060602', '200006099729', '200006099719', '200006099882', '200006099723', '200006060592', '200006099698', '200006039959', '200006099747', '200006099704', '200006039950', '200006099859', '200006099820'], 
'lg03': ['200005945970', '200005945978', '200005945972', '200006056310', '200005945979', '200005945974', '200005945968', '200006056316', '200006065948', '200006058582', '200006056309', '200005945971', '200006071504', '200006056313', '200005945973'], 
'lg04': ['200005945984', '200005945988', '200006056310', '200006056316', '200005945992', '200005945983', '200006065948', '200005945990', '200006058582', '200006056309', '200005945991', '200005945986', '200005945993', '200006071504', '200006056313']}
